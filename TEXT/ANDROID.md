Разберём XML:

Верхнее изображение:
Верхнее изображение задаётся первым Imageview. Он отображает изображение на всю ширину и на фиксированную высоту, и так же растягивает изображение под формат экрана пользователя.

Кнопка “показать данные”:
Представляет собой обычную кнопку с фиксированными размерами.

LinearLayout:
Задаёт пространство, в котором будет обрабатываться наше видео. Имеет цвет как у фона приложения. 

TextView:
Показывает текст, который показывает данные с модели в реальном времени. 

Кнопка “Добавить видео”:
Кнопка с фиксированными размерами запускает обработку модели и позволяет добавить в неё видео из галереи. 

Нижнее изображение:
То же самое что и верхнее.

Разберём MAIN_ACTIVITY:

Это полный код, на котором работает приложение. Всё что до private fun selectVideo определяет логику работы кнопок (Button( onClick = { isMenuVisible.value = !isMenuVisible.value },…), загружает изображения, и определяет константы (private lateinit var interpreter: Interpreter…). Импортируются все основные классы из Android, Jetpack Compose, Kotlin, TensorFlow Lite, Coroutine и COI. 
Private fun selectVideo запускаем выбор видео из файловой системы. Override fun onActivityResult проверяет наличие видео и передаёт его дальше. Private fun loadModel загружает модель из локальной папки assets. Private fun startProcessing начинает обработку видео перед тем как передать его модели: обработка происходит каждые 200мс (+- 5 кадров в секунду), так как для нашей задачи больше не требуется. While (timeUs < durationUs) после получения кадра отправляет его в модель и посл обработки отправляет его в UI. Private fun runModel запускает модель, масштабирует картинку до 640×640 и преобразовывает в формат Float32[1, 640, 640, 3], и выдаёт результат на нулевой класс объектов на уверенности 74%. Так как модель работает некорректно, данный порог уверенности был выставлен для имитации нормальной работы. Если бы модель работала так, как планировалось, то в коде нужно было бы поставить не 0 класс, а 1. Но мы не смогли добиться нормальной работы, что не критично, так как в реальных условиях обработка видео происходила бы через оригинальную модель pt.
